FUNCTION check_bank_records_select(v_schema IN VARCHAR2, v_obj IN VARCHAR2)
RETURN VARCHAR2 AS 
 POLICE_COUNT NUMBER := 0;
 BANK_COUNT NUMBER := 0;
BEGIN
 SELECT COUNT(*) INTO POLICE_COUNT FROM system.PUBLIC_SECURITY_EMPLOYEE WHERE NAME = SYS_CONTEXT('USERENV', 'SESSION_USER');
 SELECT COUNT(*) INTO BANK_COUNT FROM system.BANK_STAFFS WHERE NAME = SYS_CONTEXT('USERENV', 'SESSION_USER');
 IF SYS_CONTEXT('USERENV', 'SESSION_USER') = 'SYSTEM' THEN
 RETURN '';
 END IF;
IF POLICE_COUNT > 0 THEN
RETURN 'LOAN > 100000';
ELSIF BANK_COUNT > 0 THEN
RETURN 'BANK = (select BANK_BELONGING from system.BANK_STAFFS where NAME = SYS_CONTEXT(''USERENV'', ''SESSION_USER''))';
 ELSE
 RETURN 'NAME = SYS_CONTEXT(''USERENV'', ''SESSION_USER'')' ;
 END IF;
END check_bank_records_select;



FUNCTION check_bank_records_update(v_schema IN VARCHAR2, v_obj IN VARCHAR2)
RETURN VARCHAR2 AS 
BEGIN
RETURN 'BANK = (select BANK_BELONGING from system.BANK_STAFFS where NAME = SYS_CONTEXT(''USERENV'', ''SESSION_USER'')) AND N...
END check_bank_records_update;
FUNCTION check_data_access(
 schema_var IN VARCHAR2,
 table_var IN VARCHAR2
) RETURN VARCHAR2 AS
 user_identity_card_id VARCHAR2(20);
BEGIN
 -- 获取用户的 IDENTITY_CARD_ID
 SELECT IDENTITY_CARD_ID INTO user_identity_card_id
 FROM YOUR_USER_INFO_TABLE
 WHERE USER_NAME = SYS_CONTEXT('USERENV', 'SESSION_USER');
 IF (USER = 'SYSTEM' OR user_identity_card_id IN (SELECT IDENTITY_CARD_ID FROM HOSPITAL_DOCTORS)) THEN
 RETURN '1=1'; -- 允许医生用户查看所有信息，或者 SYSTEM 用户
 ELSE
 RETURN 'IDENTITY_CARD_ID = ' || user_identity_card_id;
 END IF;
END check_data_access;
